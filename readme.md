# 使用說明文件

## 專案名稱
**基於 YOLOv5 和 ZED 相機的物體偵測與機器手臂控制系統**

## 1. 專案簡介
本專案利用 YOLOv5 深度學習模型與 ZED Stereo Camera 進行物體偵測，並結合機器手臂完成指定物件的夾取與移動操作。系統可以即時處理影像資料，偵測特定物件（例如「杯子」），並執行以下流程：

1. **物體偵測**：利用 YOLOv5 模型偵測畫面中的物件。
2. **物件定位與追蹤**：結合 ZED 深度感測技術，計算物件的 3D 位置。
3. **機器手臂控制**：根據偵測結果，驅動機器手臂完成抓取和放置動作。

---

## 2. 系統需求

### 軟體需求
- **Python 版本**：3.8 或以上
- **必要套件**：
  - `torch`
  - `numpy`
  - `opencv-python`
  - `pyzed`
  - `yaml`
  - YOLOv5 相關工具函數庫

### 硬體需求
- **ZED Stereo Camera**
- **機器手臂**（如 RobotArm 類型）
- 支援 CUDA 的 GPU （建議使用 NVIDIA 顯卡）

---

## 3. 目錄結構
```
|-- yolov5/                 # YOLOv5 模型與工具庫
|   |-- data/               # 資料目錄
|   |   |-- coco.yaml       # COCO 類別名稱
|   |-- yolov5s.pt          # YOLOv5s 模型權重檔案
|-- robotAtoB.py            # 機器手臂控制模組
|-- main.py                 # 主程式
```

---

## 4. 功能說明

### 4.1 啟動步驟

1. **環境配置**：
   ```bash
   pip install torch numpy opencv-python pyzed yaml

   # Clone YOLOv5 到當前目錄
   git clone https://github.com/ultralytics/yolov5
   
   # 安裝 YOLOv5 所需依賴
   cd yolov5
   pip install -r requirements.txt

   # 下載預訓練模型檔案 (也可自行準備)
   wget https://github.com/ultralytics/yolov5/releases/download/v6.0/yolov5s.pt
   ```

2. **運行程式**：
   使用以下指令啟動系統：
   ```bash
   python detectorV1.py --weights ./yolov5/yolov5s.pt --img_size 416 --conf_thres 0.4
   ```
   - `--weights`：YOLOv5 模型權重檔案路徑
   - `--img_size`：推論時使用的影像大小（單位：像素）
   - `--conf_thres`：物件偵測的信心閾值

3. **系統啟動後的運作流程**：
   - 啟動 ZED Camera 進行影像擷取。
   - 使用 YOLOv5 模型進行物體偵測。
   - 偵測到「杯子」後，機器手臂執行以下動作：
     - 移動到目標位置並進行夾取。
     - 將物件移動到指定位置並放置。
     - 重置機器手臂位置。



### 4.2 核心功能模組

#### **YOLOv5 模型推論**
- **偵測物件**：使用預訓練的 YOLOv5 模型進行即時偵測。
- **偵測結果處理**：
  - 使用 Non-Max Suppression 過濾多餘的偵測框。
  - 解析偵測框並轉換為 3D 空間的座標數據。

#### **ZED 相機操作**
- **影像擷取**：使用 ZED 相機獲取彩色影像和深度資訊。
- **物體定位**：透過 ZED SDK 提供的 3D 重建技術，計算物件的準確位置。

#### **機器手臂控制**
- **控制流程**：
  1. 根據目標物件的位置移動到目標點。
  2. 啟動夾爪完成抓取動作。
  3. 將物件移動到指定的放置位置，並放下物件。
  4. 手臂回到初始位置待命。

---

## 5. 重要參數設定

| 參數名稱          | 功能描述                                  | 預設值                     |
|-------------------|------------------------------------------|--------------------------|
| `--weights`       | YOLOv5 模型權重檔案                     | `./yolov5/yolov5s.pt`   |
| `--img_size`      | 推論時的影像尺寸（像素）                 | `416`                   |
| `--conf_thres`    | 偵測信心閾值（0 ~ 1）                   | `0.4`                   |
| `--svo`           | 可選的 ZED SVO 檔案路徑，用於離線推論    | 無                       |

---

## 6. 注意事項

1. **相機初始化問題**：
   - 確保 ZED Camera 正確連接並安裝驅動。
   - 若初始化失敗，請檢查 ZED Camera 的固件版本。

2. **YOLOv5 模型權重**：
   - 預設使用 `yolov5s.pt`，可替換為其他模型（如 `yolov5m.pt`）。

3. **機器手臂校正**：
   - 確保手臂的初始位置與程式中的參數一致。

4. **執行效率**：
   - 建議使用 GPU 加速推論，以確保系統能夠即時處理影像。

---

## 7. 常見問題

### 問題 1：無法偵測到物件
- **解決方法**：
  1. 提高場景光線亮度，避免陰影影響。
  2. 確保相機鏡頭清潔，沒有污漬。
  3. 檢查 `conf_thres` 閾值是否設定過高。

### 問題 2：機器手臂無法正確夾取
- **解決方法**：
  1. 校正手臂的初始位置。
  2. 檢查夾爪是否有機械故障。

---

## 8. 授權與版權
本專案僅供學術研究與學習用途，禁止用於商業用途。如需商業應用，請聯繫作者取得授權。

---

